# #ï¸âƒ£ æ¯æ—¥é»„å†å¡ç‰‡

ä¸€ä¸ªæ¯æ—¥è‡ªåŠ¨ç”Ÿæˆæ¯æ—¥é»„å†`å›¾ç‰‡`ã€`è§†é¢‘`ã€ä¸Šä¼ è‡³ OSSã€å¹¶é€šè¿‡é‚®ä»¶é€šçŸ¥çš„ Node.js é¡¹ç›®ã€‚

![å¡ç‰‡é¢„è§ˆ](output/main.png)

![è§†é¢‘é¢„è§ˆ](output/main.gif)


## âœ¨ åŠŸèƒ½ç‰¹æ€§

- ğŸ“… æ¯æ—¥è‡ªåŠ¨ç”Ÿæˆ - ä¸Šæµ·æ—¶é—´æ¯å¤© 00:30 å‡†æ—¶ç”Ÿæˆå½“æ—¥é»„å†å¡ç‰‡/è§†é¢‘
- â˜ï¸ äº‘å­˜å‚¨æ”¯æŒ - è‡ªåŠ¨ä¸Šä¼ è§†é¢‘åˆ°é˜¿é‡Œäº‘ OSS
- âœ‰ï¸ é€šçŸ¥ç³»ç»Ÿ - é‚®ä»¶é€šçŸ¥ç”Ÿæˆç»“æœï¼ˆæ”¯æŒæˆåŠŸ/å¤±è´¥ï¼‰
- ğŸ”„ è‡ªåŠ¨åŒ–å·¥ä½œæµ - GitHub Actions å®šæ—¶æ‰§è¡Œå¹¶æäº¤ç»“æœ

---

## ğŸ› ï¸ é¡¹ç›®ç»“æ„

```bash
.
â”œâ”€â”€ material/            # ç´ æ
â”œâ”€â”€ output/              # åˆæˆåçš„å›¾ç‰‡å’Œè§†é¢‘
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ generate.js      # ç”Ÿæˆé»„å†å¡ç‰‡æˆ–è§†é¢‘çš„æ ¸å¿ƒé€»è¾‘
â”‚   â”œâ”€â”€ upload.js        # OSS ä¸Šä¼ æ¨¡å—
â”‚   â””â”€â”€ notify.js        # é‚®ä»¶é€šçŸ¥æ¨¡å—
â”œâ”€â”€ .env                 # ç¯å¢ƒå˜é‡é…ç½®
â”œâ”€â”€ .envtpl              # ç¯å¢ƒå˜é‡é…ç½®æ¨¡æ¿
â”œâ”€â”€ index.js             # ä¸»å…¥å£è„šæœ¬
â”œâ”€â”€ index.tpl            # ç”Ÿæˆç½‘é¡µçš„æ¨¡æ¿
â”œâ”€â”€ index.html           # ç”Ÿæˆå¡ç‰‡çš„ç½‘é¡µ
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ–¹å¼ä¸€ï¼šFork å¹¶è‡ªåŠ¨è¿è¡Œï¼ˆæ¨èï¼‰

1. ç‚¹å‡»å³ä¸Šè§’ Fork æŒ‰é’®å¤åˆ¶ä»“åº“
2. åœ¨ä»“åº“ Settings > Secrets and variables > Actions ä¸­æ·»åŠ ç¯å¢ƒå˜é‡(å‚è€ƒä¸‹æ–‡ç¯å¢ƒå˜é‡)
3. ç³»ç»Ÿå°†åœ¨æ¯æ—¥ 00:30ï¼ˆä¸Šæµ·æ—¶é—´ï¼‰è‡ªåŠ¨è¿è¡Œå¹¶æäº¤ç»“æœ

### æ–¹å¼äºŒï¼šæœ¬åœ°å¼€å‘è¿è¡Œ

1. å…‹éš†ä»“åº“

```
git clone https://github.com/chinjiaqing/daily-lunar.git
```

2. è¿›å…¥é¡¹ç›®ç›®å½•

```
cd daily-lunar
```

3. å®‰è£…ä¾èµ–

```
npm install
```

4. æ ¹ç›®å½•åˆ›å»º.env é…ç½®æ–‡ä»¶ï¼Œå¹¶ç²˜è´´.envtpl ä¸­çš„é…ç½®åˆ°.env æ–‡ä»¶ä¸­

5. è¿è¡Œé¡¹ç›®

```
npm run dev
```

## âš™ï¸ ç¯å¢ƒå˜é‡é…ç½®ï¼ˆå‡ä¸ºé€‰å¡«ï¼‰

| å˜é‡å             | æè¿°                 | ç¤ºä¾‹å€¼                          |
| ------------------ | -------------------- | ------------------------------- |
| `EMAIL_SMTP_USER`  | SMTP é‚®ç®±ç”¨æˆ·å      | your_email@163.com              |
| `EMAIL_SMTP_TOKEN` | SMTP é‚®ç®±æˆæƒä»¤ç‰Œ    | your_email_token                |
| `EMAIL_SMTP_HOST`  | SMTP æœåŠ¡å™¨åœ°å€      | \*smtp.163.com                  |
| `EMAIL_SMTP_PORT`  | SMTP æœåŠ¡å™¨ç«¯å£      | \*465                           |
| `EMAIL_RECEIVER`   | æ¥æ”¶é€šçŸ¥çš„é‚®ç®±       | receiver@qq.com                 |
| `OSS_ACCESS_KEY`   | é˜¿é‡Œäº‘ OSS AccessKey | LTAI5t...                       |
| `OSS_SECRET_KEY`   | é˜¿é‡Œäº‘ OSS SecretKey | B2cMpD...                       |
| `OSS_REGION_NAME`  | OSS å­˜å‚¨åŒºåŸŸ         | oss-cn-shanghai                 |
| `OSS_BUCKET_NAME`  | OSS å­˜å‚¨æ¡¶åç§°       | lunar-calendar                  |
| `OSS_DIR_PATH`     | OSS å­˜å‚¨è·¯å¾„         | \*output                        |
| `CALLBACK_URL`     | ç”Ÿæˆå®Œæˆå›è°ƒåœ°å€     | https://api.example.com/webhook |

### å›è°ƒ CALLBACK_URL

å°†ä¼šä»¥ POST è¯·æ±‚å‘é€åˆ°`CALLBACK_URL`:

```json
{
    "date":"2025-08-07",
    "oss_url":"http://yourossname.oss-cn-chengdu.aliyuncs.com/output/main.mp4",
    "oss_url":"output/main.mp4"
}
```

---

å¦‚æœæ‚¨è§‰å¾—è¿˜ä¸é”™ï¼Œè¯· star æ”¯æŒï¼Œæ„Ÿè°¢ï¼
